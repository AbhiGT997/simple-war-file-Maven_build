# Stage 1: Build the Java web application
FROM maven:3.8.3-openjdk-11 AS build
MAINTAINER root
WORKDIR /usr/maven
COPY pom.xml /usr/maven/
COPY src /src/maven
RUN mvn package

# Stage 2: Deploy the WAR file to Tomcat

FROM tomcat
RUN apt-get update && apt-get install -y nano
RUN apt-get install -y git && apt-get install -y tree
RUN apt install -y openjdk-11-jre-headless
ENV CATALINA_HOME: /usr/local/tomcat
ENV JRE_HOME: /opt/java/openjdk/bin/java
COPY --from=build /usr/maven/target/hello-1.0.war /usr/local/tomcat/webapps.dist
EXPOSE 8080
CMD ["catalina.sh", "run"]

